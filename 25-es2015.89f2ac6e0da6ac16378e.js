(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{upr6:function(e,t,c){"use strict";c.r(t),c.d(t,"CheckoutdetailPageModule",(function(){return re}));var n=c("ofXK"),r=c("3Pt+"),o=c("tyNb"),a=c("TEn/"),i=c("mrSG"),s=c("z6cu"),g=c("IzEk"),l=c("un/a"),d=c("JIr8"),u=c("tk/3"),h=c("pwB6"),p=c("fXoL"),m=c("gren"),y=c("0IaG"),b=c("xHqg"),f=c("bTqV"),v=c("QibW"),O=c("kmnG"),C=c("qFsG"),S=c("B9HH"),x=c("6xI8"),I=c("sYmb");function k(e,t){if(1&e&&(p.hc(0,"div",24),p.cc(1,"app-callphone",25),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Cc("mobile",e.ygen.getSettings().oncallsupport)}}function w(e,t){if(1&e){const e=p.ic();p.hc(0,"button",26),p.pc("click",(function(){p.Nc(e);const t=p.tc(3);return t.ygen.inviteviawhatsapp(t.ygen.getSettings().oncallwhatsappsupport,"Hi")})),p.cc(1,"ion-icon",27),p.gc()}}function N(e,t){if(1&e&&(p.hc(0,"div",19),p.hc(1,"h3"),p.Xc(2),p.uc(3,"translate"),p.gc(),p.hc(4,"p"),p.Xc(5),p.gc(),p.hc(6,"div",20),p.hc(7,"div",21),p.Vc(8,k,2,1,"div",22),p.Vc(9,w,2,0,"button",23),p.gc(),p.gc(),p.gc()),2&e){const e=p.tc(2);p.Ob(2),p.Yc(p.vc(3,4,"Store's Instructions")),p.Ob(3),p.Yc(e.ygen.getSettings().checkoutordermsg),p.Ob(3),p.Cc("ngIf",e.ygen.getSettings().oncallsupport&&(""+e.ygen.getSettings().oncallsupport).length>1),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().oncallwhatsappsupport&&(""+e.ygen.getSettings().oncallwhatsappsupport).length>1)}}function X(e,t){if(1&e&&(p.hc(0,"div",28),p.cc(1,"ion-icon",29),p.hc(2,"h3"),p.Xc(3),p.uc(4,"translate"),p.gc(),p.hc(5,"p"),p.Xc(6),p.gc(),p.cc(7,"app-callphone",25),p.hc(8,"ion-button",30),p.Xc(9),p.uc(10,"translate"),p.gc(),p.gc()),2&e){const e=p.tc(2);p.Ob(3),p.Yc(p.vc(4,4,"No more Orders or Shop Subscription Expired")),p.Ob(3),p.Yc(e.ygen.getSettings().stopordersmessage),p.Ob(1),p.Cc("mobile",e.ygen.getSettings().oncallsupport),p.Ob(2),p.Zc("",p.vc(10,6,"Come back again")," ")}}function D(e,t){1&e&&(p.Xc(0),p.uc(1,"translate")),2&e&&p.Yc(p.vc(1,1,"Pick your Delivery option"))}function F(e,t){1&e&&(p.hc(0,"div"),p.hc(1,"h1"),p.Xc(2),p.uc(3,"translate"),p.gc(),p.gc()),2&e&&(p.Ob(2),p.Yc(p.vc(3,1,"No Delivery Options Setup by Store; You can not proceed further")))}function P(e,t){1&e&&(p.hc(0,"mat-radio-button",33),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Zc(" ",p.vc(2,1,"Home Delivery"),""))}function V(e,t){1&e&&(p.hc(0,"mat-radio-button",34),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Zc(" ",p.vc(2,1,"Store Pickup"),""))}function q(e,t){if(1&e&&(p.hc(0,"mat-radio-group",13),p.Vc(1,P,3,3,"mat-radio-button",31),p.Vc(2,V,3,3,"mat-radio-button",32),p.gc()),2&e){const e=p.tc(2);p.Cc("formControl",e.deliveryType),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().onlyhomepickup),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().onlystorepickup)}}function T(e,t){1&e&&(p.Xc(0),p.uc(1,"translate")),2&e&&p.Yc(p.vc(1,1,"Pick your Payment option"))}function Y(e,t){1&e&&(p.hc(0,"mat-radio-button",35),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Zc(" ",p.vc(2,1,"Cash on Delivery"),""))}function M(e,t){1&e&&(p.hc(0,"mat-radio-button",36),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Zc(" ",p.vc(2,1,"Pay Now")," "))}function L(e,t){1&e&&(p.Xc(0),p.uc(1,"translate")),2&e&&p.Yc(p.vc(1,1,"More Details"))}function A(e,t){1&e&&(p.hc(0,"legend"),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Yc(p.vc(2,1,"Your Details")))}function E(e,t){1&e&&(p.hc(0,"legend"),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Yc(p.vc(2,1,"Delivery Address")))}function j(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.userName,"Name"),"")}}function z(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.mobile,"mobile"),"")}}function Z(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.unitName,"Building Name"),"")}}function H(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.address,"Address"),"")}}function _(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.city,"City"),"")}}function B(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.state,"State"),"")}}function R(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.zip,"Postal Code"),"")}}function U(e,t){if(1&e&&(p.hc(0,"mat-error"),p.Xc(1),p.gc()),2&e){const e=p.tc(3);p.Ob(1),p.Zc(" ",e.getErrorMessage(e.addressForm.controls.country,"Country"),"")}}const G=function(){return["in"]};function $(e,t){if(1&e){const e=p.ic();p.hc(0,"div"),p.hc(1,"form",37),p.hc(2,"fieldset"),p.Vc(3,A,3,3,"legend",4),p.Vc(4,E,3,3,"legend",4),p.hc(5,"table",38),p.hc(6,"tr"),p.hc(7,"td"),p.hc(8,"mat-form-field",17),p.hc(9,"mat-label"),p.Xc(10),p.uc(11,"translate"),p.gc(),p.cc(12,"input",39),p.Vc(13,j,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.hc(14,"tr"),p.hc(15,"td"),p.hc(16,"mat-form-field",17),p.cc(17,"ngx-mat-intl-tel-input",40),p.uc(18,"translate"),p.hc(19,"mat-hint"),p.Xc(20),p.uc(21,"translate"),p.gc(),p.Vc(22,z,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.hc(23,"tr"),p.hc(24,"td"),p.hc(25,"mat-form-field",17),p.hc(26,"mat-label"),p.Xc(27),p.uc(28,"translate"),p.gc(),p.cc(29,"input",41),p.Vc(30,Z,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.gc(),p.hc(31,"p"),p.hc(32,"mat-form-field",17),p.hc(33,"mat-label"),p.Xc(34),p.uc(35,"translate"),p.gc(),p.hc(36,"textarea",42),p.Xc(37,"\n                  "),p.gc(),p.Vc(38,H,2,1,"mat-error",4),p.gc(),p.gc(),p.hc(39,"table",38),p.hc(40,"tr"),p.hc(41,"td"),p.hc(42,"mat-form-field",17),p.hc(43,"mat-label"),p.Xc(44),p.uc(45,"translate"),p.gc(),p.cc(46,"input",43),p.Vc(47,_,2,1,"mat-error",4),p.gc(),p.gc(),p.hc(48,"td"),p.hc(49,"mat-form-field",17),p.hc(50,"mat-label"),p.Xc(51),p.uc(52,"translate"),p.gc(),p.cc(53,"input",44),p.Vc(54,B,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.hc(55,"tr"),p.hc(56,"td"),p.hc(57,"mat-form-field",17),p.hc(58,"mat-label"),p.Xc(59),p.uc(60,"translate"),p.gc(),p.cc(61,"input",45,46),p.hc(63,"mat-hint",47),p.Xc(64),p.gc(),p.Vc(65,R,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.hc(66,"tr"),p.hc(67,"td"),p.hc(68,"mat-form-field",48),p.cc(69,"input",49,50),p.gc(),p.hc(71,"mat-select-country",51),p.pc("onCountrySelected",(function(t){p.Nc(e);const c=p.tc(2);return c.onCountrySelected(t,c.addressForm.controls.country)})),p.gc(),p.Vc(72,U,2,1,"mat-error",4),p.gc(),p.gc(),p.gc(),p.gc(),p.gc(),p.gc()}if(2&e){const e=p.Kc(62),t=p.Kc(70),c=p.tc(2);p.Ob(1),p.Cc("formGroup",c.addressForm),p.Ob(2),p.Cc("ngIf",c.isrequiredAddressForm()),p.Ob(1),p.Cc("ngIf",!c.isrequiredAddressForm()),p.Ob(6),p.Yc(p.vc(11,27,"Name")),p.Ob(3),p.Cc("ngIf",c.addressForm.controls.userName.invalid),p.Ob(4),p.Dc("placeholder",p.vc(18,29,"mobile")),p.Cc("cssClass","custom")("preferredCountries",p.Fc(43,G))("enablePlaceholder",!0)("enableSearch",!0)("formControl",c.addressForm.controls.mobile)("required",!0),p.Ob(3),p.Yc(p.vc(21,31,"Your Mobile..")),p.Ob(2),p.Cc("ngIf",c.addressForm.controls.mobile.invalid),p.Ob(5),p.Yc(p.vc(28,33,"Building Name")),p.Ob(3),p.Cc("ngIf",c.addressForm.controls.unitName.invalid),p.Ob(4),p.Yc(p.vc(35,35,"Address")),p.Ob(4),p.Cc("ngIf",c.addressForm.controls.address.invalid),p.Ob(6),p.Yc(p.vc(45,37,"City")),p.Ob(3),p.Cc("ngIf",c.addressForm.controls.city.invalid),p.Ob(4),p.Yc(p.vc(52,39,"State")),p.Ob(3),p.Cc("ngIf",c.addressForm.controls.state.invalid),p.Ob(5),p.Yc(p.vc(60,41,"Postal Code")),p.Ob(5),p.Zc("",e.value.length,"/5"),p.Ob(1),p.Cc("ngIf",c.addressForm.controls.zip.invalid),p.Ob(6),p.Cc("country",t.value),p.Ob(1),p.Cc("ngIf",c.addressForm.controls.country.invalid)}}function J(e,t){1&e&&(p.hc(0,"div",28),p.cc(1,"ion-icon",29),p.hc(2,"h3"),p.Xc(3),p.uc(4,"translate"),p.gc(),p.hc(5,"p"),p.Xc(6),p.uc(7,"translate"),p.gc(),p.hc(8,"ion-button",30),p.Xc(9),p.uc(10,"translate"),p.gc(),p.gc()),2&e&&(p.Ob(3),p.Yc(p.vc(4,3,"Your Cart is Empty")),p.Ob(3),p.Yc(p.vc(7,5,"Lets get you started")),p.Ob(3),p.Zc("",p.vc(10,7,"Start shopping")," "))}function K(e,t){if(1&e&&(p.hc(0,"ion-content",5),p.Vc(1,N,10,6,"div",6),p.Vc(2,X,11,8,"div",7),p.hc(3,"mat-vertical-stepper",8,9),p.hc(5,"mat-step"),p.Vc(6,D,2,3,"ng-template",10),p.hc(7,"div"),p.hc(8,"div"),p.hc(9,"div"),p.Vc(10,F,4,3,"div",4),p.Vc(11,q,3,3,"mat-radio-group",11),p.gc(),p.gc(),p.gc(),p.hc(12,"div"),p.hc(13,"button",12),p.Xc(14),p.uc(15,"translate"),p.gc(),p.gc(),p.gc(),p.hc(16,"mat-step"),p.Vc(17,T,2,3,"ng-template",10),p.hc(18,"div"),p.hc(19,"div"),p.hc(20,"div"),p.hc(21,"mat-radio-group",13),p.Vc(22,Y,3,3,"mat-radio-button",14),p.Vc(23,M,3,3,"mat-radio-button",15),p.gc(),p.gc(),p.gc(),p.gc(),p.hc(24,"div"),p.hc(25,"button",12),p.Xc(26),p.uc(27,"translate"),p.gc(),p.gc(),p.gc(),p.hc(28,"mat-step"),p.Vc(29,L,2,3,"ng-template",10),p.hc(30,"div"),p.hc(31,"form",16),p.hc(32,"fieldset"),p.hc(33,"legend"),p.Xc(34),p.uc(35,"translate"),p.gc(),p.hc(36,"mat-form-field",17),p.hc(37,"mat-label"),p.Xc(38),p.uc(39,"translate"),p.gc(),p.cc(40,"textarea",18),p.gc(),p.gc(),p.gc(),p.Vc(41,$,73,44,"div",4),p.gc(),p.gc(),p.gc(),p.Vc(42,J,11,9,"div",7),p.gc()),2&e){const e=p.tc();p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().checkoutordermsg&&e.ygen.getSettings().checkoutordermsg.length>0),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().stoporders||!e.ygen.isActiveSubscription()),p.Ob(1),p.Cc("linear",!1),p.Ob(7),p.Cc("ngIf",!(e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup)),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup),p.Ob(3),p.Yc(p.vc(15,15,"Next")),p.Ob(7),p.Cc("formControl",e.paymentType),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().offercod),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().onlinepay),p.Ob(3),p.Yc(p.vc(27,17,"Next")),p.Ob(8),p.Yc(p.vc(35,19,"Delivery Note-Instruction")),p.Ob(4),p.Yc(p.vc(39,21,"Leave a note-instruction about order")),p.Ob(2),p.Cc("formControl",e.deliveryNote),p.Ob(1),p.Cc("ngIf","HD"==e.deliveryType.value||e.isrequiredAddressForm()),p.Ob(1),p.Cc("ngIf",0==e.ycat.getcartcount())}}function Q(e,t){if(1&e&&(p.hc(0,"ion-toolbar"),p.hc(1,"div",53),p.hc(2,"ion-text"),p.hc(3,"h3"),p.Xc(4),p.uc(5,"translate"),p.gc(),p.gc(),p.hc(6,"ion-text"),p.hc(7,"h3"),p.Xc(8),p.gc(),p.gc(),p.gc(),p.gc()),2&e){const e=p.tc(2);p.Ob(4),p.Yc(p.vc(5,3,"Delivery Charges")),p.Ob(4),p.ad(" ",e.ygen.getcurrencysymbol()," ",e.ygen.getSettings().deliverycharges," ")}}function W(e,t){if(1&e){const e=p.ic();p.hc(0,"ion-button",57),p.pc("click",(function(){p.Nc(e);const t=p.tc(3);return t.payoptions(t.ycat.getcart())})),p.Xc(1),p.uc(2,"translate"),p.gc()}if(2&e){const e=p.tc(3);p.Cc("disabled",e.isReady()),p.Ob(1),p.Zc(" ",p.vc(2,2,"Complete Order"),"")}}function ee(e,t){1&e&&(p.hc(0,"ion-button",58),p.Xc(1),p.uc(2,"translate"),p.gc()),2&e&&(p.Ob(1),p.Zc(" ",p.vc(2,1,"No More Orders"),""))}function te(e,t){if(1&e&&(p.hc(0,"ion-toolbar",0),p.hc(1,"div",54),p.hc(2,"ion-text"),p.hc(3,"h3"),p.Xc(4),p.uc(5,"translate"),p.gc(),p.gc(),p.Vc(6,W,3,4,"ion-button",55),p.Vc(7,ee,3,3,"ion-button",56),p.hc(8,"ion-text"),p.hc(9,"h3"),p.Xc(10),p.gc(),p.gc(),p.gc(),p.gc()),2&e){const e=p.tc(2);p.Cc("color","warning"),p.Ob(4),p.Yc(p.vc(5,6,"Total")),p.Ob(2),p.Cc("ngIf",!e.ygen.getSettings().stoporders&&e.ygen.isActiveSubscription()),p.Ob(1),p.Cc("ngIf",e.ygen.getSettings().stoporders&&!e.ygen.isActiveSubscription()),p.Ob(3),p.ad(" ",e.ygen.getcurrencysymbol()," ",e.getTotal()," ")}}function ce(e,t){if(1&e&&(p.hc(0,"ion-footer"),p.Vc(1,Q,9,5,"ion-toolbar",4),p.Vc(2,te,11,8,"ion-toolbar",52),p.gc()),2&e){const e=p.tc();p.Ob(1),p.Cc("ngIf","HD"==e.deliveryType.value&&!e.ygen.getSettings().freedelivery&&e.ygen.getSettings().freedeliveryoveramount&&e.ygen.getSettings().freedeliveryamount>e.ycat.getTotal()||!e.ygen.getSettings().freedeliveryoveramount&&!e.ygen.getSettings().freedelivery),p.Ob(1),p.Cc("ngIf",e.ycat.getcartcount()>0)}}const ne=[{path:"",component:(()=>{class e{constructor(e,t,c,n,r,o,a,i,s,g,l,d,u,h,p,m){this.centerdb=e,this.http=t,this.ngxUiLoaderService=c,this.ynotification=n,this.yovalidation=r,this.yauth=o,this.ydata=a,this.router=i,this.ygen=s,this.events=g,this.ycat=l,this.alertme=d,this.ystripe=u,this.ypaytm=h,this.ypay=p,this.dialog=m}buildForm(e){let t=e.country?e.country:"India",c=e.mobile?e.mobile:this.yauth.myprofile.mobile;this.addressForm=new r.g({userName:new r.d(e.userName,[r.v.required,r.v.minLength(2),r.v.maxLength(30)]),mobile:new r.d(c,[r.v.required,r.v.minLength(2),r.v.maxLength(30)]),unitName:new r.d(e.unitName,[r.v.required,r.v.minLength(2),r.v.maxLength(30)]),address:new r.d(e.address,[r.v.required,r.v.minLength(2),r.v.maxLength(100)]),city:new r.d(e.city,[r.v.required,r.v.minLength(2),r.v.maxLength(30)]),state:new r.d(e.state,[r.v.required,r.v.minLength(2),r.v.maxLength(30)]),zip:new r.d(e.zip,{validators:[r.v.required,r.v.minLength(2),r.v.maxLength(30)],asyncValidators:[Object(h.gb)(this.ygen)],updateOn:"blur"}),country:new r.d(t,{validators:[r.v.required,r.v.minLength(2),r.v.maxLength(30)]})});let n="HD";this.ygen.getSettings().onlystorepickup&&(n="SP"),this.ygen.getSettings().onlystorepickup||this.ygen.getSettings().onlyhomepickup||(n=""),this.deliveryType=new r.d(n,[r.v.required,r.v.max(2)]),setTimeout(()=>{this.paymentType.setValue(n)},100);let o="COD";this.ygen.getSettings().onlinepay&&(o="PNO"),this.ygen.getSettings().onlinepay||this.ygen.getSettings().offercod||(o=""),this.paymentType=new r.d(o,[r.v.required,r.v.max(3)]),setTimeout(()=>{this.paymentType.setValue(o)},100),this.deliveryNote=new r.d("Thanks",[r.v.required,r.v.max(100)]),this.addressForm.controls.mobile.setValue(c),this.addressForm.controls.country.setValue(t)}isrequiredAddressForm(){return!(!this.payer||this.payer.userName&&this.payer.mobile)}ngOnInit(){this.ynotification.getStoreAdmins(),this.ygen.getUid()?this.getUserProfile().then(e=>{this.ngxUiLoaderService.stop(),this.payer=e,this.payer?this.buildForm(this.payer):(console.error("blank form"),this.buildForm({}))}).finally(()=>{this.ngxUiLoaderService.stop()}):(this.yauth.setlanding("/checkoutdetail"),this.router.navigate(["/login"],{}))}getUserProfile(){return Object(i.a)(this,void 0,void 0,(function*(){this.ngxUiLoaderService.start();const e=yield this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).valueChanges().pipe(Object(g.a)(1)).toPromise();return yield e}))}addtocart(e,t,c){c&&(t.orderqty=0);let n=t.orderqty?t.orderqty+e:1;n>t.maxqty?this.alertme.openSnackBar(`Maximum quantiy you can order is ${t.maxqty}`,"Ok"):(Object.assign(t,{orderqty:n}),this.ycat.iscartItem(t)?this.ycat.updatequantity(t):1==n&&(this.alertme.openSnackBar(`Your shopping cart updated with ${t.orderqty} quantity`,"Ok"),this.ycat.addtocart(t))),0==t.orderqty&&this.ycat.delete(t)}pay(e){let t=""+ +new Date,c=this.ygen.randomletter()+this.ygen.randomletter()+~~(1e3*Math.random())+t.substring(t.length-4);e.forEach(e=>{e.$key?e.originalkey=e.$key:console.warn("no Key.."),delete e.$key});let n={trancurrency:this.ygen.getTranCurrency().toLowerCase(),sendorderid:c,isorder:!0,payload:e,amount:this.getTotal(),orderByName:this.addressForm.controls.userName.value,orderByPhone:this.addressForm.controls.mobile.value,deliveryAddress:this.ygen.getAddress(this.addressForm.value),zipcode:this.addressForm.value.zip,city:this.addressForm.value.city,storeAddress:this.ygen.getAddress(h.eb.selectedtenant),storePhone:this.ygen.getCommunityContactPhone(),wheredelivery:this.deliveryType.value,deliverynote:this.deliveryNote.value,storename:this.ygen.communityName(),orderedBy:this.payer.uid,gateway:"?"};"INVALID"!=this.addressForm.status&&this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).update(this.addressForm.value),this.ygen.getSettings().usepaytm?n.gateway="paytm":this.ygen.getSettings().userazorpay?n.gateway="razorpay":this.ygen.getSettings().usestripe&&(n.gateway="stripe"),this.events.subscribe("order:success["+c+"]",e=>{this.yauth.setlanding(null),this.events.unsubscribe("order:success["+c+"]"),this.ygen.findDistanceForOrder(n.deliveryAddress,!0);let t=this.ydata.getDatabase().createPushId();e.key=t,this.ydata.getDatabase().list(h.R.getpath()+"/shop/orders").set(t,e),this.ynotification.sendNotificationToTakeUser(this.payer.uid,{message:"Order Successfully placed with, OrderID=["+c+"]",path:"order?orderid="+t},"Order Success",!0,!0,!0),this.alertme.successdata("Order Successfully placed with, OrderID=["+c+"]").then(e=>{console.log("done",e)}),"razorpay"==n.gateway&&this.capturepayment(n),this.router.navigate(["/order"],{queryParams:{orderid:t,orderkey:c,orderplaced:!0}}),this.ycat.emptycart(),this.ycat.updateProductQuantity()}),"COD"==this.paymentType.value?(n.paymentmethod="COD",Object.assign(n,{orderedBy:this.payer.uid,odt:+new Date,ostatus:"NEW"}),this.events.publish("order:success["+n.sendorderid+"]",n)):(this.ygen.getSettings(),this.ygen.getSettings(),this.ygen.getSettings(),n.gateway="stripe",this.ystripe.pay(n))}onCountrySelected(e,t){t.setValue(e.name)}payoptions(e){this.pay(e)}getErrorMessage(e,t){let c="",n=this.getMeErrors({placeholder:t});return Object.keys(n).some(t=>{if(e.errors[t])return c=n[t],!0}),c}getMeErrors(e){return this.yovalidation.genericErrors(e)}getTotal(){let e=this.ycat.getTotal();return"HD"!=this.deliveryType.value||this.ygen.getSettings().freedelivery||(this.ygen.getSettings().freedeliveryoveramount&&this.ygen.getSettings().freedeliveryamount>this.ycat.getTotal()?e+=this.ygen.getSettings().deliverycharges:this.ygen.getSettings().freedeliveryoveramount||(e+=this.ygen.getSettings().deliverycharges)),e}isReady(){let e=!0;return"HD"==this.deliveryType.value?e=!this.addressForm.valid:"SP"==this.deliveryType.value&&(e=this.isrequiredAddressForm()&&!this.addressForm.valid),e}capturepayment(e){let t=e.key,c=this.yauth.getappSettings(),n=c.testonlinepay;c.testonlinepay||(n=!1);let r=`https://guarded-sea-64699.herokuapp.com/rest/razor/capture?testmode=${n}&paymentid=${e.paymentResponse.payment_id}`,o={amount:100*e.amount,currency:"INR"};const a={headers:new u.d({"Content-Type":"application/json",Authorization:"yoyo"})};this.http.post(r,o,a).pipe(Object(l.a)(1)).subscribe(e=>{let c={paymentcaptured:!0,paymentcaptureddetail:e};console.log("capture payment",e),e.err||this.ydata.getDatabase().list(h.R.getpath()+"/shop/orders").update(t,c)},e=>{this.ydata.getDatabase().list(h.R.getpath()+"/shop/orders").update(t,{paymentcaptured:!1,paymentcaptureddetail:{error:"Did not go well at server"}})})}createpickup(e){if(this.ygen.getSettings().deliveryenabled){let t=+new Date,c={pickup_time:this.ygen.getTimeinformat(t,"HH:mm:ss"),pickup_date:this.ygen.getDateinformat(t,"YYYY-MM-DD"),pickup_location:this.ygen.getSettings().warehouse,expected_package_count:1};const n={headers:new u.d({"Content-Type":"application/json",Authorization:"replacetoken"})};let r="https://staging-express.delhivery.com/fm/request/new/";this.ygen.getSettings().testdelivery?n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokentest):(n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokenlive),r="https://track.delhivery.com/\u200bfm/request/new/"),this.http.post(r,c,n).pipe(Object(l.a)(3),Object(d.a)(e=>Object(s.a)(e))).subscribe(t=>{let c={deliverytrack:t,manualpickup:!1};this.orderlist.getListRefer().update(e,c),this.alertme.openSnackBar("Pick up request created [Auto]","Done")},t=>{this.orderlist.getListRefer().update(e,{manualpickup:!0}),this.alertme.openSnackBar("Pick up request created [Manual]","Ok")})}}onPopstate(){console.log("coming in"),this.ystripe.getHandler().close()}}return e.\u0275fac=function(t){return new(t||e)(p.bc(h.R),p.bc(u.b),p.bc(m.c),p.bc(h.W),p.bc(h.fb),p.bc(h.O),p.bc(h.S),p.bc(o.j),p.bc(h.V),p.bc(h.ab),p.bc(h.Q),p.bc(h.a),p.bc(h.N),p.bc(h.cb),p.bc(h.bb),p.bc(y.b))},e.\u0275cmp=p.Vb({type:e,selectors:[["app-checkoutdetail"]],hostBindings:function(e,t){1&e&&p.pc("popstate",(function(){return t.onPopstate()}),!1,p.Mc)},decls:9,vars:3,consts:[[3,"color"],["slot","start"],["src","https://guarded-sea-64699.herokuapp.com/favicon.png",2,"display","none"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],["text-center","","class","msgTextSection",4,"ngIf"],["text-center","","class","cartTextSection",4,"ngIf"],[3,"linear"],["stepper",""],["matStepLabel",""],["class","example-radio-group","aria-label","Select an option",3,"formControl",4,"ngIf"],["color","warn","mat-button","","matStepperNext",""],["aria-label","Select an option",1,"example-radio-group",3,"formControl"],["class","example-radio-button","value","COD",4,"ngIf"],["class","example-radio-button","value","PNO",4,"ngIf"],[1,"example-form"],[1,"example-full-width"],["matInput","","placeholder","Ex. Thanks...",3,"formControl"],["text-center","",1,"msgTextSection"],[2,"right","20px","position","absolute"],[2,"display","inline-flex"],["style","padding-right: 5px;",4,"ngIf"],["mat-mini-fab","","style","background: lightgreen;",3,"click",4,"ngIf"],[2,"padding-right","5px"],[3,"mobile"],["mat-mini-fab","",2,"background","lightgreen",3,"click"],["name","logo-whatsapp",2,"font-size","x-large"],["text-center","",1,"cartTextSection"],["name","cart","role","img","aria-label","cart",1,"cartIcon"],["color","success","routerLink","/products"],["class","example-radio-button","value","HD",4,"ngIf"],["class","example-radio-button","value","SP",4,"ngIf"],["value","HD",1,"example-radio-button"],["value","SP",1,"example-radio-button"],["value","COD",1,"example-radio-button"],["value","PNO",1,"example-radio-button"],[1,"example-form",3,"formGroup"],["cellspacing","0",1,"example-full-width"],["yogagainv2InputUpper","","matInput","","formControlName","userName"],[3,"cssClass","preferredCountries","enablePlaceholder","placeholder","enableSearch","formControl","required"],["yogagainv2InputUpper","","matInput","","formControlName","unitName"],["matInput","","placeholder","Ex. CIVIL LINES","formControlName","address"],["matInput","","placeholder","Ex. GONDIA","formControlName","city"],["matInput","","placeholder","Ex. MAHARASHTRA","formControlName","state"],["type","number","matInput","","maxlength","5","placeholder","Ex. 94105","formControlName","zip"],["postalCode",""],["align","end"],[2,"display","none"],["matInput","","type","text","formControlName","country","required","true"],["whatcountry",""],[3,"country","onCountrySelected"],[3,"color",4,"ngIf"],[1,"delivery"],[1,"footerCartSection"],["color","danger",3,"disabled","click",4,"ngIf"],["color","danger",4,"ngIf"],["color","danger",3,"disabled","click"],["color","danger"]],template:function(e,t){1&e&&(p.hc(0,"ion-header"),p.hc(1,"ion-toolbar",0),p.hc(2,"ion-buttons",1),p.cc(3,"ion-back-button"),p.gc(),p.hc(4,"ion-title"),p.Xc(5,"Payment/Delivery"),p.gc(),p.gc(),p.gc(),p.cc(6,"img",2),p.Vc(7,K,43,23,"ion-content",3),p.Vc(8,ce,3,2,"ion-footer",4)),2&e&&(p.Ob(1),p.Cc("color","warning"),p.Ob(6),p.Cc("ngIf",t.payer),p.Ob(1),p.Cc("ngIf",t.payer&&t.ycat.getcartcount()>0))},directives:[a.y,a.fb,a.j,a.f,a.g,a.db,n.m,a.s,b.e,b.a,b.b,f.a,b.d,v.b,r.o,r.e,r.w,r.p,r.q,O.c,O.g,C.b,r.b,h.j,a.z,a.i,a.qb,o.l,v.a,r.h,h.u,r.f,S.a,r.u,O.f,r.s,r.j,x.a,O.b,a.w,a.ab],pipes:[I.c],styles:[".footerCartSection[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.delivery[_ngcontent-%COMP%], .footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-form-field-infix[_ngcontent-%COMP%]{width:150px;max-width:150px}  .mat-form-field-infix{width:150px!important}.example-form[_ngcontent-%COMP%]{padding:20px}.example-full-width[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{padding-right:8px}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.msgTextSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px}"]}),e})()}];let re=(()=>{class e{}return e.\u0275mod=p.Zb({type:e}),e.\u0275inj=p.Yb({factory:function(t){return new(t||e)},imports:[[n.c,r.i,a.gb,h.J,h.o,h.b,r.t,o.n.forChild(ne)]]}),e})()}}]);