function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var c=0;c<t.length;c++){var r=t[c];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,c){return t&&_defineProperties(e.prototype,t),c&&_defineProperties(e,c),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{upr6:function(e,t,c){"use strict";c.r(t),c.d(t,"CheckoutdetailPageModule",(function(){return oe}));var r=c("ofXK"),n=c("3Pt+"),a=c("tyNb"),o=c("TEn/"),i=c("mrSG"),s=c("z6cu"),g=c("IzEk"),l=c("un/a"),d=c("JIr8"),u=c("tk/3"),p=c("pwB6"),h=c("fXoL"),y=c("gren"),m=c("0IaG"),f=c("xHqg"),v=c("bTqV"),b=c("QibW"),O=c("kmnG"),C=c("qFsG"),S=c("B9HH"),x=c("6xI8"),k=c("sYmb");function I(e,t){if(1&e&&(h.hc(0,"div",24),h.cc(1,"app-callphone",25),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Cc("mobile",c.ygen.getSettings().oncallsupport)}}function w(e,t){if(1&e){var c=h.ic();h.hc(0,"button",26),h.pc("click",(function(){h.Nc(c);var e=h.tc(3);return e.ygen.inviteviawhatsapp(e.ygen.getSettings().oncallwhatsappsupport,"Hi")})),h.cc(1,"ion-icon",27),h.gc()}}function N(e,t){if(1&e&&(h.hc(0,"div",19),h.hc(1,"h3"),h.Xc(2),h.uc(3,"translate"),h.gc(),h.hc(4,"p"),h.Xc(5),h.gc(),h.hc(6,"div",20),h.hc(7,"div",21),h.Vc(8,I,2,1,"div",22),h.Vc(9,w,2,0,"button",23),h.gc(),h.gc(),h.gc()),2&e){var c=h.tc(2);h.Ob(2),h.Yc(h.vc(3,4,"Store's Instructions")),h.Ob(3),h.Yc(c.ygen.getSettings().checkoutordermsg),h.Ob(3),h.Cc("ngIf",c.ygen.getSettings().oncallsupport&&(""+c.ygen.getSettings().oncallsupport).length>1),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().oncallwhatsappsupport&&(""+c.ygen.getSettings().oncallwhatsappsupport).length>1)}}function X(e,t){if(1&e&&(h.hc(0,"div",28),h.cc(1,"ion-icon",29),h.hc(2,"h3"),h.Xc(3),h.uc(4,"translate"),h.gc(),h.hc(5,"p"),h.Xc(6),h.gc(),h.cc(7,"app-callphone",25),h.hc(8,"ion-button",30),h.Xc(9),h.uc(10,"translate"),h.gc(),h.gc()),2&e){var c=h.tc(2);h.Ob(3),h.Yc(h.vc(4,4,"No more Orders or Shop Subscription Expired")),h.Ob(3),h.Yc(c.ygen.getSettings().stopordersmessage),h.Ob(1),h.Cc("mobile",c.ygen.getSettings().oncallsupport),h.Ob(2),h.Zc("",h.vc(10,6,"Come back again")," ")}}function P(e,t){1&e&&(h.Xc(0),h.uc(1,"translate")),2&e&&h.Yc(h.vc(1,1,"Pick your Delivery option"))}function D(e,t){1&e&&(h.hc(0,"div"),h.hc(1,"h1"),h.Xc(2),h.uc(3,"translate"),h.gc(),h.gc()),2&e&&(h.Ob(2),h.Yc(h.vc(3,1,"No Delivery Options Setup by Store; You can not proceed further")))}function F(e,t){1&e&&(h.hc(0,"mat-radio-button",33),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"Home Delivery"),""))}function V(e,t){1&e&&(h.hc(0,"mat-radio-button",34),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"Store Pickup"),""))}function T(e,t){if(1&e&&(h.hc(0,"mat-radio-group",13),h.Vc(1,F,3,3,"mat-radio-button",31),h.Vc(2,V,3,3,"mat-radio-button",32),h.gc()),2&e){var c=h.tc(2);h.Cc("formControl",c.deliveryType),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().onlyhomepickup),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().onlystorepickup)}}function q(e,t){1&e&&(h.Xc(0),h.uc(1,"translate")),2&e&&h.Yc(h.vc(1,1,"Pick your Payment option"))}function Y(e,t){1&e&&(h.hc(0,"mat-radio-button",35),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"Cash on Delivery"),""))}function M(e,t){1&e&&(h.hc(0,"mat-radio-button",36),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"Pay Now")," "))}function L(e,t){1&e&&(h.Xc(0),h.uc(1,"translate")),2&e&&h.Yc(h.vc(1,1,"More Details"))}function A(e,t){1&e&&(h.hc(0,"legend"),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Yc(h.vc(2,1,"Your Details")))}function E(e,t){1&e&&(h.hc(0,"legend"),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Yc(h.vc(2,1,"Delivery Address")))}function _(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.userName,"Name"),"")}}function j(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.mobile,"mobile"),"")}}function z(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.unitName,"Building Name"),"")}}function Z(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.address,"Address"),"")}}function H(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.city,"City"),"")}}function R(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.state,"State"),"")}}function B(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.zip,"Postal Code"),"")}}function U(e,t){if(1&e&&(h.hc(0,"mat-error"),h.Xc(1),h.gc()),2&e){var c=h.tc(3);h.Ob(1),h.Zc(" ",c.getErrorMessage(c.addressForm.controls.country,"Country"),"")}}var G=function(){return["in"]};function J(e,t){if(1&e){var c=h.ic();h.hc(0,"div"),h.hc(1,"form",37),h.hc(2,"fieldset"),h.Vc(3,A,3,3,"legend",4),h.Vc(4,E,3,3,"legend",4),h.hc(5,"table",38),h.hc(6,"tr"),h.hc(7,"td"),h.hc(8,"mat-form-field",17),h.hc(9,"mat-label"),h.Xc(10),h.uc(11,"translate"),h.gc(),h.cc(12,"input",39),h.Vc(13,_,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.hc(14,"tr"),h.hc(15,"td"),h.hc(16,"mat-form-field",17),h.cc(17,"ngx-mat-intl-tel-input",40),h.uc(18,"translate"),h.hc(19,"mat-hint"),h.Xc(20),h.uc(21,"translate"),h.gc(),h.Vc(22,j,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.hc(23,"tr"),h.hc(24,"td"),h.hc(25,"mat-form-field",17),h.hc(26,"mat-label"),h.Xc(27),h.uc(28,"translate"),h.gc(),h.cc(29,"input",41),h.Vc(30,z,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.gc(),h.hc(31,"p"),h.hc(32,"mat-form-field",17),h.hc(33,"mat-label"),h.Xc(34),h.uc(35,"translate"),h.gc(),h.hc(36,"textarea",42),h.Xc(37,"\n                  "),h.gc(),h.Vc(38,Z,2,1,"mat-error",4),h.gc(),h.gc(),h.hc(39,"table",38),h.hc(40,"tr"),h.hc(41,"td"),h.hc(42,"mat-form-field",17),h.hc(43,"mat-label"),h.Xc(44),h.uc(45,"translate"),h.gc(),h.cc(46,"input",43),h.Vc(47,H,2,1,"mat-error",4),h.gc(),h.gc(),h.hc(48,"td"),h.hc(49,"mat-form-field",17),h.hc(50,"mat-label"),h.Xc(51),h.uc(52,"translate"),h.gc(),h.cc(53,"input",44),h.Vc(54,R,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.hc(55,"tr"),h.hc(56,"td"),h.hc(57,"mat-form-field",17),h.hc(58,"mat-label"),h.Xc(59),h.uc(60,"translate"),h.gc(),h.cc(61,"input",45,46),h.hc(63,"mat-hint",47),h.Xc(64),h.gc(),h.Vc(65,B,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.hc(66,"tr"),h.hc(67,"td"),h.hc(68,"mat-form-field",48),h.cc(69,"input",49,50),h.gc(),h.hc(71,"mat-select-country",51),h.pc("onCountrySelected",(function(e){h.Nc(c);var t=h.tc(2);return t.onCountrySelected(e,t.addressForm.controls.country)})),h.gc(),h.Vc(72,U,2,1,"mat-error",4),h.gc(),h.gc(),h.gc(),h.gc(),h.gc(),h.gc()}if(2&e){var r=h.Kc(62),n=h.Kc(70),a=h.tc(2);h.Ob(1),h.Cc("formGroup",a.addressForm),h.Ob(2),h.Cc("ngIf",a.isrequiredAddressForm()),h.Ob(1),h.Cc("ngIf",!a.isrequiredAddressForm()),h.Ob(6),h.Yc(h.vc(11,27,"Name")),h.Ob(3),h.Cc("ngIf",a.addressForm.controls.userName.invalid),h.Ob(4),h.Dc("placeholder",h.vc(18,29,"mobile")),h.Cc("cssClass","custom")("preferredCountries",h.Fc(43,G))("enablePlaceholder",!0)("enableSearch",!0)("formControl",a.addressForm.controls.mobile)("required",!0),h.Ob(3),h.Yc(h.vc(21,31,"Your Mobile..")),h.Ob(2),h.Cc("ngIf",a.addressForm.controls.mobile.invalid),h.Ob(5),h.Yc(h.vc(28,33,"Building Name")),h.Ob(3),h.Cc("ngIf",a.addressForm.controls.unitName.invalid),h.Ob(4),h.Yc(h.vc(35,35,"Address")),h.Ob(4),h.Cc("ngIf",a.addressForm.controls.address.invalid),h.Ob(6),h.Yc(h.vc(45,37,"City")),h.Ob(3),h.Cc("ngIf",a.addressForm.controls.city.invalid),h.Ob(4),h.Yc(h.vc(52,39,"State")),h.Ob(3),h.Cc("ngIf",a.addressForm.controls.state.invalid),h.Ob(5),h.Yc(h.vc(60,41,"Postal Code")),h.Ob(5),h.Zc("",r.value.length,"/5"),h.Ob(1),h.Cc("ngIf",a.addressForm.controls.zip.invalid),h.Ob(6),h.Cc("country",n.value),h.Ob(1),h.Cc("ngIf",a.addressForm.controls.country.invalid)}}function K(e,t){1&e&&(h.hc(0,"div",28),h.cc(1,"ion-icon",29),h.hc(2,"h3"),h.Xc(3),h.uc(4,"translate"),h.gc(),h.hc(5,"p"),h.Xc(6),h.uc(7,"translate"),h.gc(),h.hc(8,"ion-button",30),h.Xc(9),h.uc(10,"translate"),h.gc(),h.gc()),2&e&&(h.Ob(3),h.Yc(h.vc(4,3,"Your Cart is Empty")),h.Ob(3),h.Yc(h.vc(7,5,"Lets get you started")),h.Ob(3),h.Zc("",h.vc(10,7,"Start shopping")," "))}function Q(e,t){if(1&e&&(h.hc(0,"ion-content",5),h.Vc(1,N,10,6,"div",6),h.Vc(2,X,11,8,"div",7),h.hc(3,"mat-vertical-stepper",8,9),h.hc(5,"mat-step"),h.Vc(6,P,2,3,"ng-template",10),h.hc(7,"div"),h.hc(8,"div"),h.hc(9,"div"),h.Vc(10,D,4,3,"div",4),h.Vc(11,T,3,3,"mat-radio-group",11),h.gc(),h.gc(),h.gc(),h.hc(12,"div"),h.hc(13,"button",12),h.Xc(14),h.uc(15,"translate"),h.gc(),h.gc(),h.gc(),h.hc(16,"mat-step"),h.Vc(17,q,2,3,"ng-template",10),h.hc(18,"div"),h.hc(19,"div"),h.hc(20,"div"),h.hc(21,"mat-radio-group",13),h.Vc(22,Y,3,3,"mat-radio-button",14),h.Vc(23,M,3,3,"mat-radio-button",15),h.gc(),h.gc(),h.gc(),h.gc(),h.hc(24,"div"),h.hc(25,"button",12),h.Xc(26),h.uc(27,"translate"),h.gc(),h.gc(),h.gc(),h.hc(28,"mat-step"),h.Vc(29,L,2,3,"ng-template",10),h.hc(30,"div"),h.hc(31,"form",16),h.hc(32,"fieldset"),h.hc(33,"legend"),h.Xc(34),h.uc(35,"translate"),h.gc(),h.hc(36,"mat-form-field",17),h.hc(37,"mat-label"),h.Xc(38),h.uc(39,"translate"),h.gc(),h.cc(40,"textarea",18),h.gc(),h.gc(),h.gc(),h.Vc(41,J,73,44,"div",4),h.gc(),h.gc(),h.gc(),h.Vc(42,K,11,9,"div",7),h.gc()),2&e){var c=h.tc();h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().checkoutordermsg&&c.ygen.getSettings().checkoutordermsg.length>0),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().stoporders||!c.ygen.isActiveSubscription()),h.Ob(1),h.Cc("linear",!1),h.Ob(7),h.Cc("ngIf",!(c.ygen.getSettings().onlystorepickup||c.ygen.getSettings().onlyhomepickup)),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().onlystorepickup||c.ygen.getSettings().onlyhomepickup),h.Ob(3),h.Yc(h.vc(15,15,"Next")),h.Ob(7),h.Cc("formControl",c.paymentType),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().offercod),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().onlinepay),h.Ob(3),h.Yc(h.vc(27,17,"Next")),h.Ob(8),h.Yc(h.vc(35,19,"Delivery Note-Instruction")),h.Ob(4),h.Yc(h.vc(39,21,"Leave a note-instruction about order")),h.Ob(2),h.Cc("formControl",c.deliveryNote),h.Ob(1),h.Cc("ngIf","HD"==c.deliveryType.value||c.isrequiredAddressForm()),h.Ob(1),h.Cc("ngIf",0==c.ycat.getcartcount())}}function W(e,t){if(1&e&&(h.hc(0,"ion-toolbar"),h.hc(1,"div",53),h.hc(2,"ion-text"),h.hc(3,"h3"),h.Xc(4),h.uc(5,"translate"),h.gc(),h.gc(),h.hc(6,"ion-text"),h.hc(7,"h3"),h.Xc(8),h.gc(),h.gc(),h.gc(),h.gc()),2&e){var c=h.tc(2);h.Ob(4),h.Yc(h.vc(5,3,"Delivery Charges")),h.Ob(4),h.ad(" ",c.ygen.getcurrencysymbol()," ",c.ygen.getSettings().deliverycharges," ")}}function $(e,t){if(1&e){var c=h.ic();h.hc(0,"ion-button",57),h.pc("click",(function(){h.Nc(c);var e=h.tc(3);return e.payoptions(e.ycat.getcart())})),h.Xc(1),h.uc(2,"translate"),h.gc()}if(2&e){var r=h.tc(3);h.Cc("disabled",r.isReady()),h.Ob(1),h.Zc(" ",h.vc(2,2,"Complete Order"),"")}}function ee(e,t){1&e&&(h.hc(0,"ion-button",58),h.Xc(1),h.uc(2,"translate"),h.gc()),2&e&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"No More Orders"),""))}function te(e,t){if(1&e&&(h.hc(0,"ion-toolbar",0),h.hc(1,"div",54),h.hc(2,"ion-text"),h.hc(3,"h3"),h.Xc(4),h.uc(5,"translate"),h.gc(),h.gc(),h.Vc(6,$,3,4,"ion-button",55),h.Vc(7,ee,3,3,"ion-button",56),h.hc(8,"ion-text"),h.hc(9,"h3"),h.Xc(10),h.gc(),h.gc(),h.gc(),h.gc()),2&e){var c=h.tc(2);h.Cc("color","warning"),h.Ob(4),h.Yc(h.vc(5,6,"Total")),h.Ob(2),h.Cc("ngIf",!c.ygen.getSettings().stoporders&&c.ygen.isActiveSubscription()),h.Ob(1),h.Cc("ngIf",c.ygen.getSettings().stoporders&&!c.ygen.isActiveSubscription()),h.Ob(3),h.ad(" ",c.ygen.getcurrencysymbol()," ",c.getTotal()," ")}}function ce(e,t){if(1&e&&(h.hc(0,"ion-footer"),h.Vc(1,W,9,5,"ion-toolbar",4),h.Vc(2,te,11,8,"ion-toolbar",52),h.gc()),2&e){var c=h.tc();h.Ob(1),h.Cc("ngIf","HD"==c.deliveryType.value&&!c.ygen.getSettings().freedelivery&&c.ygen.getSettings().freedeliveryoveramount&&c.ygen.getSettings().freedeliveryamount>c.ycat.getTotal()||!c.ygen.getSettings().freedeliveryoveramount&&!c.ygen.getSettings().freedelivery),h.Ob(1),h.Cc("ngIf",c.ycat.getcartcount()>0)}}var re,ne,ae=[{path:"",component:(re=function(){function e(t,c,r,n,a,o,i,s,g,l,d,u,p,h,y,m){_classCallCheck(this,e),this.centerdb=t,this.http=c,this.ngxUiLoaderService=r,this.ynotification=n,this.yovalidation=a,this.yauth=o,this.ydata=i,this.router=s,this.ygen=g,this.events=l,this.ycat=d,this.alertme=u,this.ystripe=p,this.ypaytm=h,this.ypay=y,this.dialog=m}return _createClass(e,[{key:"buildForm",value:function(e){var t=this,c=e.country?e.country:"India",r=e.mobile?e.mobile:this.yauth.myprofile.mobile;this.addressForm=new n.g({userName:new n.d(e.userName,[n.v.required,n.v.minLength(2),n.v.maxLength(30)]),mobile:new n.d(r,[n.v.required,n.v.minLength(2),n.v.maxLength(30)]),unitName:new n.d(e.unitName,[n.v.required,n.v.minLength(2),n.v.maxLength(30)]),address:new n.d(e.address,[n.v.required,n.v.minLength(2),n.v.maxLength(100)]),city:new n.d(e.city,[n.v.required,n.v.minLength(2),n.v.maxLength(30)]),state:new n.d(e.state,[n.v.required,n.v.minLength(2),n.v.maxLength(30)]),zip:new n.d(e.zip,{validators:[n.v.required,n.v.minLength(2),n.v.maxLength(30)],asyncValidators:[Object(p.gb)(this.ygen)],updateOn:"blur"}),country:new n.d(c,{validators:[n.v.required,n.v.minLength(2),n.v.maxLength(30)]})});var a="HD";this.ygen.getSettings().onlystorepickup&&(a="SP"),this.ygen.getSettings().onlystorepickup||this.ygen.getSettings().onlyhomepickup||(a=""),this.deliveryType=new n.d(a,[n.v.required,n.v.max(2)]),setTimeout((function(){t.paymentType.setValue(a)}),100);var o="COD";this.ygen.getSettings().onlinepay&&(o="PNO"),this.ygen.getSettings().onlinepay||this.ygen.getSettings().offercod||(o=""),this.paymentType=new n.d(o,[n.v.required,n.v.max(3)]),setTimeout((function(){t.paymentType.setValue(o)}),100),this.deliveryNote=new n.d("Thanks",[n.v.required,n.v.max(100)]),this.addressForm.controls.mobile.setValue(r),this.addressForm.controls.country.setValue(c)}},{key:"isrequiredAddressForm",value:function(){return!(!this.payer||this.payer.userName&&this.payer.mobile)}},{key:"ngOnInit",value:function(){var e=this;this.ynotification.getStoreAdmins(),this.ygen.getUid()?this.getUserProfile().then((function(t){e.ngxUiLoaderService.stop(),e.payer=t,e.payer?e.buildForm(e.payer):(console.error("blank form"),e.buildForm({}))})).finally((function(){e.ngxUiLoaderService.stop()})):(this.yauth.setlanding("/checkoutdetail"),this.router.navigate(["/login"],{}))}},{key:"getUserProfile",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ngxUiLoaderService.start(),e.next=3,this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).valueChanges().pipe(Object(g.a)(1)).toPromise();case 3:return t=e.sent,e.next=6,t;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"addtocart",value:function(e,t,c){c&&(t.orderqty=0);var r=t.orderqty?t.orderqty+e:1;r>t.maxqty?this.alertme.openSnackBar("Maximum quantiy you can order is ".concat(t.maxqty),"Ok"):(Object.assign(t,{orderqty:r}),this.ycat.iscartItem(t)?this.ycat.updatequantity(t):1==r&&(this.alertme.openSnackBar("Your shopping cart updated with ".concat(t.orderqty," quantity"),"Ok"),this.ycat.addtocart(t))),0==t.orderqty&&this.ycat.delete(t)}},{key:"pay",value:function(e){var t=this,c=""+ +new Date,r=this.ygen.randomletter()+this.ygen.randomletter()+~~(1e3*Math.random())+c.substring(c.length-4);e.forEach((function(e){e.$key?e.originalkey=e.$key:console.warn("no Key.."),delete e.$key}));var n={trancurrency:this.ygen.getTranCurrency().toLowerCase(),sendorderid:r,isorder:!0,payload:e,amount:this.getTotal(),orderByName:this.addressForm.controls.userName.value,orderByPhone:this.addressForm.controls.mobile.value,deliveryAddress:this.ygen.getAddress(this.addressForm.value),zipcode:this.addressForm.value.zip,city:this.addressForm.value.city,storeAddress:this.ygen.getAddress(p.eb.selectedtenant),storePhone:this.ygen.getCommunityContactPhone(),wheredelivery:this.deliveryType.value,deliverynote:this.deliveryNote.value,storename:this.ygen.communityName(),orderedBy:this.payer.uid,gateway:"?"};"INVALID"!=this.addressForm.status&&this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).update(this.addressForm.value),this.ygen.getSettings().usepaytm?n.gateway="paytm":this.ygen.getSettings().userazorpay?n.gateway="razorpay":this.ygen.getSettings().usestripe&&(n.gateway="stripe"),this.events.subscribe("order:success["+r+"]",(function(e){t.yauth.setlanding(null),t.events.unsubscribe("order:success["+r+"]"),t.ygen.findDistanceForOrder(n.deliveryAddress,!0);var c=t.ydata.getDatabase().createPushId();e.key=c,t.ydata.getDatabase().list(p.R.getpath()+"/shop/orders").set(c,e),t.ynotification.sendNotificationToTakeUser(t.payer.uid,{message:"Order Successfully placed with, OrderID=["+r+"]",path:"order?orderid="+c},"Order Success",!0,!0,!0),t.alertme.successdata("Order Successfully placed with, OrderID=["+r+"]").then((function(e){console.log("done",e)})),"razorpay"==n.gateway&&t.capturepayment(n),t.router.navigate(["/order"],{queryParams:{orderid:c,orderkey:r,orderplaced:!0}}),t.ycat.emptycart(),t.ycat.updateProductQuantity()})),"COD"==this.paymentType.value?(n.paymentmethod="COD",Object.assign(n,{orderedBy:this.payer.uid,odt:+new Date,ostatus:"NEW"}),this.events.publish("order:success["+n.sendorderid+"]",n)):(this.ygen.getSettings(),this.ygen.getSettings(),this.ygen.getSettings(),n.gateway="stripe",this.ystripe.pay(n))}},{key:"onCountrySelected",value:function(e,t){t.setValue(e.name)}},{key:"payoptions",value:function(e){this.pay(e)}},{key:"getErrorMessage",value:function(e,t){var c="",r=this.getMeErrors({placeholder:t});return Object.keys(r).some((function(t){if(e.errors[t])return c=r[t],!0})),c}},{key:"getMeErrors",value:function(e){return this.yovalidation.genericErrors(e)}},{key:"getTotal",value:function(){var e=this.ycat.getTotal();return"HD"!=this.deliveryType.value||this.ygen.getSettings().freedelivery||(this.ygen.getSettings().freedeliveryoveramount&&this.ygen.getSettings().freedeliveryamount>this.ycat.getTotal()?e+=this.ygen.getSettings().deliverycharges:this.ygen.getSettings().freedeliveryoveramount||(e+=this.ygen.getSettings().deliverycharges)),e}},{key:"isReady",value:function(){var e=!0;return"HD"==this.deliveryType.value?e=!this.addressForm.valid:"SP"==this.deliveryType.value&&(e=this.isrequiredAddressForm()&&!this.addressForm.valid),e}},{key:"capturepayment",value:function(e){var t=this,c=e.key,r=this.yauth.getappSettings(),n=r.testonlinepay;r.testonlinepay||(n=!1);var a="https://guarded-sea-64699.herokuapp.com/rest/razor/capture?testmode=".concat(n,"&paymentid=").concat(e.paymentResponse.payment_id),o={amount:100*e.amount,currency:"INR"},i={headers:new u.d({"Content-Type":"application/json",Authorization:"yoyo"})};this.http.post(a,o,i).pipe(Object(l.a)(1)).subscribe((function(e){var r={paymentcaptured:!0,paymentcaptureddetail:e};console.log("capture payment",e),e.err||t.ydata.getDatabase().list(p.R.getpath()+"/shop/orders").update(c,r)}),(function(e){t.ydata.getDatabase().list(p.R.getpath()+"/shop/orders").update(c,{paymentcaptured:!1,paymentcaptureddetail:{error:"Did not go well at server"}})}))}},{key:"createpickup",value:function(e){var t=this;if(this.ygen.getSettings().deliveryenabled){var c=+new Date,r={pickup_time:this.ygen.getTimeinformat(c,"HH:mm:ss"),pickup_date:this.ygen.getDateinformat(c,"YYYY-MM-DD"),pickup_location:this.ygen.getSettings().warehouse,expected_package_count:1},n={headers:new u.d({"Content-Type":"application/json",Authorization:"replacetoken"})},a="https://staging-express.delhivery.com/fm/request/new/";this.ygen.getSettings().testdelivery?n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokentest):(n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokenlive),a="https://track.delhivery.com/\u200bfm/request/new/"),this.http.post(a,r,n).pipe(Object(l.a)(3),Object(d.a)((function(e){return Object(s.a)(e)}))).subscribe((function(c){var r={deliverytrack:c,manualpickup:!1};t.orderlist.getListRefer().update(e,r),t.alertme.openSnackBar("Pick up request created [Auto]","Done")}),(function(c){t.orderlist.getListRefer().update(e,{manualpickup:!0}),t.alertme.openSnackBar("Pick up request created [Manual]","Ok")}))}}},{key:"onPopstate",value:function(){console.log("coming in"),this.ystripe.getHandler().close()}}]),e}(),re.\u0275fac=function(e){return new(e||re)(h.bc(p.R),h.bc(u.b),h.bc(y.c),h.bc(p.W),h.bc(p.fb),h.bc(p.O),h.bc(p.S),h.bc(a.j),h.bc(p.V),h.bc(p.ab),h.bc(p.Q),h.bc(p.a),h.bc(p.N),h.bc(p.cb),h.bc(p.bb),h.bc(m.b))},re.\u0275cmp=h.Vb({type:re,selectors:[["app-checkoutdetail"]],hostBindings:function(e,t){1&e&&h.pc("popstate",(function(){return t.onPopstate()}),!1,h.Mc)},decls:9,vars:3,consts:[[3,"color"],["slot","start"],["src","https://guarded-sea-64699.herokuapp.com/favicon.png",2,"display","none"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],["text-center","","class","msgTextSection",4,"ngIf"],["text-center","","class","cartTextSection",4,"ngIf"],[3,"linear"],["stepper",""],["matStepLabel",""],["class","example-radio-group","aria-label","Select an option",3,"formControl",4,"ngIf"],["color","warn","mat-button","","matStepperNext",""],["aria-label","Select an option",1,"example-radio-group",3,"formControl"],["class","example-radio-button","value","COD",4,"ngIf"],["class","example-radio-button","value","PNO",4,"ngIf"],[1,"example-form"],[1,"example-full-width"],["matInput","","placeholder","Ex. Thanks...",3,"formControl"],["text-center","",1,"msgTextSection"],[2,"right","20px","position","absolute"],[2,"display","inline-flex"],["style","padding-right: 5px;",4,"ngIf"],["mat-mini-fab","","style","background: lightgreen;",3,"click",4,"ngIf"],[2,"padding-right","5px"],[3,"mobile"],["mat-mini-fab","",2,"background","lightgreen",3,"click"],["name","logo-whatsapp",2,"font-size","x-large"],["text-center","",1,"cartTextSection"],["name","cart","role","img","aria-label","cart",1,"cartIcon"],["color","success","routerLink","/products"],["class","example-radio-button","value","HD",4,"ngIf"],["class","example-radio-button","value","SP",4,"ngIf"],["value","HD",1,"example-radio-button"],["value","SP",1,"example-radio-button"],["value","COD",1,"example-radio-button"],["value","PNO",1,"example-radio-button"],[1,"example-form",3,"formGroup"],["cellspacing","0",1,"example-full-width"],["yogagainv2InputUpper","","matInput","","formControlName","userName"],[3,"cssClass","preferredCountries","enablePlaceholder","placeholder","enableSearch","formControl","required"],["yogagainv2InputUpper","","matInput","","formControlName","unitName"],["matInput","","placeholder","Ex. CIVIL LINES","formControlName","address"],["matInput","","placeholder","Ex. GONDIA","formControlName","city"],["matInput","","placeholder","Ex. MAHARASHTRA","formControlName","state"],["type","number","matInput","","maxlength","5","placeholder","Ex. 94105","formControlName","zip"],["postalCode",""],["align","end"],[2,"display","none"],["matInput","","type","text","formControlName","country","required","true"],["whatcountry",""],[3,"country","onCountrySelected"],[3,"color",4,"ngIf"],[1,"delivery"],[1,"footerCartSection"],["color","danger",3,"disabled","click",4,"ngIf"],["color","danger",4,"ngIf"],["color","danger",3,"disabled","click"],["color","danger"]],template:function(e,t){1&e&&(h.hc(0,"ion-header"),h.hc(1,"ion-toolbar",0),h.hc(2,"ion-buttons",1),h.cc(3,"ion-back-button"),h.gc(),h.hc(4,"ion-title"),h.Xc(5,"Payment/Delivery"),h.gc(),h.gc(),h.gc(),h.cc(6,"img",2),h.Vc(7,Q,43,23,"ion-content",3),h.Vc(8,ce,3,2,"ion-footer",4)),2&e&&(h.Ob(1),h.Cc("color","warning"),h.Ob(6),h.Cc("ngIf",t.payer),h.Ob(1),h.Cc("ngIf",t.payer&&t.ycat.getcartcount()>0))},directives:[o.y,o.fb,o.j,o.f,o.g,o.db,r.m,o.s,f.e,f.a,f.b,v.a,f.d,b.b,n.o,n.e,n.w,n.p,n.q,O.c,O.g,C.b,n.b,p.j,o.z,o.i,o.qb,a.l,b.a,n.h,p.u,n.f,S.a,n.u,O.f,n.s,n.j,x.a,O.b,o.w,o.ab],pipes:[k.c],styles:[".footerCartSection[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.delivery[_ngcontent-%COMP%], .footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-form-field-infix[_ngcontent-%COMP%]{width:150px;max-width:150px}  .mat-form-field-infix{width:150px!important}.example-form[_ngcontent-%COMP%]{padding:20px}.example-full-width[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{padding-right:8px}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.msgTextSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px}"]}),re)}],oe=((ne=function e(){_classCallCheck(this,e)}).\u0275mod=h.Zb({type:ne}),ne.\u0275inj=h.Yb({factory:function(e){return new(e||ne)},imports:[[r.c,n.i,o.gb,p.J,p.o,p.b,n.t,a.n.forChild(ae)]]}),ne)}}]);